{"name":"swedishbankid","strategy":"oauth2","options":{"authorizationURL":"https://preprod.signicat.com/oidc/authorize?signicat_profile=default&acr_values=urn:signicat:oidc:method:sbid","tokenURL":"https://preprod.signicat.com/oidc/token","scope":"profile openid signicat.national_id","scripts":{"fetchUserProfile":"function(access_token, ctx, callback) {\n  request.get('https://preprod.signicat.com/oidc/userinfo', {\n    'headers': {\n      'Authorization': 'Bearer ' + access_token,\n      'User-Agent': 'Auth0'\n    }\n  }, function(e, r, b) {\n    if (e) return callback(e);\n    if (r.statusCode !== 200) return callback(new Error('StatusCode:' + r.statusCode));\n\t\tvar profile = JSON.parse(b)\n\n\t\tprofile.user_id = profile.sub;\n\t\tprofile.email_verified = true;\n\t\tprofile.ssn = profile['signicat.national_id'];\n\t\tprofile.email = profile.ssn + \"@bankid.com\";  \n\t\tprofile.aal = 3;\n\t\tprofile.ial = 3;\n\t\t\t\t \n\t\tcallback(null, profile);\n  });\n}"}}}