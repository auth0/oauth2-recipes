{"name":"microsoft","strategy":"oauth2","options":{"authorizationURL":"https://login.microsoftonline.com/common/oauth2/v2.0/authorize","tokenURL":"https://login.microsoftonline.com/common/oauth2/v2.0/token","scope":"https://graph.microsoft.com/User.Read","scripts":{"fetchUserProfile":"function(accessToken, ctx, cb) {\n  request.get('https://graph.microsoft.com/v1.0/me', {\n    headers: {\n      'Authorization': 'Bearer ' + accessToken\n    }\n  }, function(e, r, b) {\n    if (e) return cb(e);\n    if (r.statusCode !== 200) return cb(new Error('StatusCode: ' + r.statusCode));\n    var profile = JSON.parse(b);\n    // call oauth2 APIwith the accesstoken and create the profile\n    cb(null, {\n      email: profile.mail,\n      email_verified: true,\n      user_id: profile.id,\n      nickname: profile.displayName\n    });\n  });\n}"}}}