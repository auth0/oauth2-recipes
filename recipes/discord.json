{"name":"discord","strategy":"oauth2","options":{"authorizationURL":"https://discordapp.com/api/oauth2/authorize","tokenURL":"https://discordapp.com/api/oauth2/token","scope":"identify email guilds guilds.join","scripts":{"fetchUserProfile":"function(accessToken, ctx, cb) {\n  // call oauth2 APIwith the accesstoken and create the profile\n  request.get(\n    'https://discordapp.com/api/users/@me', {\n      headers: {\n        Authorization: 'Bearer ' + accessToken\n      }\n    },\n    function(err, response, body) {\n      if (err) {\n        cb(err);\n        return;\n      }\n\n      var profile = JSON.parse(body);\n      profile.oauthToken = accessToken;\n      request.get(\n        'https://discordapp.com/api/users/@me/guilds', {\n          headers: {\n            Authorization: 'Bearer ' + accessToken\n          }\n        },\n        function(err, response, body) {\n          if (err) {\n            cb(err);\n            return;\n          }\n\n          profile.guilds = JSON.parse(body);\n          cb(null, profile);\n        }\n      );\n    }\n  );\n}"}}}