{"name":"relpro-uat","strategy":"oauth2","options":{"authorizationURL":"https://test.relpro.com/oauth/","tokenURL":"https://test.relpro.com/prospector/v1/oauth/token","scope":"offline-access","scripts":{"fetchUserProfile":"function(accessToken, ctx, cb) {\n  //ctxObj = JSON.parse(ctx);\n\n  cb(new Error(\"Token is: -->\" + JSON.stringify(ctx)));\n\n  request.get('https://test.relpro.com/prospector/v1/user', {\n    headers: {\n      'Authorization': 'Bearer ' + ctxObj.access_token\n    }\n  }, function(e, r, b) {\n    if (e) return cb(e);\n    if (r.statusCode !== 200) return cb(new Error('StatusCode: ' + r.statusCode));\n\n    var text = b.replace(/([^\"]+)|(\"[^\"]+\")/g, function($0, $1, $2) {\n      if ($1) {\n        return $1.replace(/\\s/g, '');\n      } else {\n        return $2;\n      }\n    });\n\n    var body = JSON.parse(text);\n\n    var profile = {\n      user_id: body.id\n    };\n    cb(null, profile);\n  });\n}"}}}