{"name":"vk","strategy":"oauth2","options":{"authorizationURL":"https://oauth.vk.com/authorize","tokenURL":"https://oauth.vk.com/access_token","scope":"email","scripts":{"fetchUserProfile":"function(accessToken, ctx, cb) {\n\n  var vkontakte_api_url = \"https://api.vk.com/method/users.get\";\n\n  request.get(vkontakte_api_url, {\n    qs: {\n      access_token: accessToken,\n      v: 5.87,\n      fields: 'photo_200,has_photo',\n      json: true\n    }\n  }, function(e, r, b) {\n\n    if (e) return cb(e);\n    if (r.statusCode !== 200) return cb(new Error('StatusCode: ' + r.statusCode));\n\n    var profile = JSON.parse(b).response[0];\n\n    profile.email = ctx.email;\n    profile.user_id = profile.id;\n    if (profile.has_photo) profile.picture = profile.photo_200;\n\n    cb(null, profile);\n  });\n}"}}}